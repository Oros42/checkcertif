<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="615px" preserveAspectRatio="none" style="width:600px;height:615px;" version="1.1" viewBox="0 0 600 615" width="600px" zoomAndPan="magnify"><defs><filter height="300%" id="f1at3wod7d4x4j" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#ADD8E6" height="600.25" style="stroke: #A80036; stroke-width: 1.0;" width="232.5" x="4" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="94.75" y="16.0669">Firefox</text><rect fill="#FFFFFF" filter="url(#f1at3wod7d4x4j)" height="308.7266" style="stroke: #000000; stroke-width: 2.0;" width="559" x="30" y="162.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="39" x2="39" y1="58.4297" y2="565.9531"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="161.5" x2="161.5" y1="58.4297" y2="565.9531"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="336" x2="336" y1="58.4297" y2="565.9531"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="498" x2="498" y1="58.4297" y2="565.9531"/><rect fill="#FEFECE" filter="url(#f1at3wod7d4x4j)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="59" x="8" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="15" y="43.1279">Firefox</text><rect fill="#FEFECE" filter="url(#f1at3wod7d4x4j)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="59" x="8" y="564.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="15" y="584.9482">Firefox</text><rect fill="#FEFECE" filter="url(#f1at3wod7d4x4j)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="90.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="97.5" y="43.1279">checkcertif addon</text><rect fill="#FEFECE" filter="url(#f1at3wod7d4x4j)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="90.5" y="564.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="97.5" y="584.9482">checkcertif addon</text><rect fill="#FEFECE" filter="url(#f1at3wod7d4x4j)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="266" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="123" x="273" y="43.1279">checkcertif server</text><rect fill="#FEFECE" filter="url(#f1at3wod7d4x4j)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="266" y="564.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="123" x="273" y="584.9482">checkcertif server</text><rect fill="#FEFECE" filter="url(#f1at3wod7d4x4j)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="417" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="144" x="424" y="43.1279">https://exemple.com</text><rect fill="#FEFECE" filter="url(#f1at3wod7d4x4j)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="417" y="564.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="144" x="424" y="584.9482">https://exemple.com</text><polygon fill="#A80036" points="486,85.5625,496,89.5625,486,93.5625,490,89.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39.5" x2="492" y1="89.5625" y2="89.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="46.5" y="84.4966">GET / POST / PUT / WSS</text><polygon fill="#A80036" points="50.5,114.6953,40.5,118.6953,50.5,122.6953,46.5,118.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="44.5" x2="497" y1="118.6953" y2="118.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="56.5" y="113.6294">certificate + page</text><polygon fill="#A80036" points="149.5,143.8281,159.5,147.8281,149.5,151.8281,153.5,147.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39.5" x2="155.5" y1="147.8281" y2="147.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="46.5" y="142.7622">send certificate</text><path d="M30,162.8281 L107,162.8281 L107,169.8281 L97,179.8281 L30,179.8281 L30,162.8281 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="308.7266" style="stroke: #000000; stroke-width: 2.0;" width="559" x="30" y="162.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="45" y="175.895">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="132" x="122" y="175.0386">[checkcertif servers]</text><polygon fill="#FBFB77" filter="url(#f1at3wod7d4x4j)" points="50,184.9609,273,184.9609,283,218.9609,273,252.9609,50,252.9609,40,218.9609,50,184.9609" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="52" y="201.0278">Put https://exemple.com</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="56" y="216.1606">+ random AES key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="52" y="231.2935">in GPG message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="52" y="246.4263">Use checkcertif server's public key</text><polygon fill="#A80036" points="324.5,275.625,334.5,279.625,324.5,283.625,328.5,279.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="161.5" x2="330.5" y1="279.625" y2="279.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="168.5" y="274.5591">send GPG message</text><polygon fill="#FBFB77" filter="url(#f1at3wod7d4x4j)" points="270,292.625,403,292.625,413,311.625,403,330.625,270,330.625,260,311.625,270,292.625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="272" y="308.6919">Open GPG message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="272" y="323.8247">and get URL</text><polygon fill="#A80036" points="486,353.0234,496,357.0234,486,361.0234,490,357.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="336.5" x2="492" y1="357.0234" y2="357.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="343.5" y="351.9575">ask certificate</text><polygon fill="#A80036" points="347.5,382.1563,337.5,386.1563,347.5,390.1563,343.5,386.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="341.5" x2="497" y1="386.1563" y2="386.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="353.5" y="381.0903">certificat</text><polygon fill="#FBFB77" filter="url(#f1at3wod7d4x4j)" points="175,399.1563,498,399.1563,508,418.1563,498,437.1563,175,437.1563,165,418.1563,175,399.1563" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="307" x="177" y="415.2231">Generate the sha1 and sha256 of the certificate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="319" x="177" y="430.356">Put it with random data in AES 256 GCM message</text><polygon fill="#A80036" points="172.5,459.5547,162.5,463.5547,172.5,467.5547,168.5,463.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="166.5" x2="335.5" y1="463.5547" y2="463.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="178.5" y="458.4888">AES 256 GCM message</text><polygon fill="#FBFB77" filter="url(#f1at3wod7d4x4j)" points="80,483.5547,243,483.5547,253,502.5547,243,521.5547,80,521.5547,70,502.5547,80,483.5547" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="82" y="499.6216">If all hashs are same : ok</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="82" y="514.7544">else warning</text><polygon fill="#A80036" points="50.5,543.9531,40.5,547.9531,50.5,551.9531,46.5,547.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="44.5" x2="160.5" y1="547.9531" y2="547.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="56.5" y="542.8872">Ok or warning</text><!--MD5=[5cc49fb63b13c18c503a60f3e0695847]
@startuml
box "Firefox" #LightBlue
	participant Firefox
	participant "checkcertif addon" as chkaddon
end box
participant "checkcertif server" as chksrv
participant "https://exemple.com" as websrv

Firefox -> websrv: GET / POST / PUT / WSS
websrv -> Firefox: certificate + page

Firefox -> chkaddon: send certificate

loop checkcertif servers
	hnote over chkaddon : Put https://exemple.com\n + random AES key\nin GPG message\nUse checkcertif server's public key
	chkaddon -> chksrv: send GPG message

	hnote over chksrv : Open GPG message\nand get URL

	chksrv -> websrv: ask certificate
	websrv -> chksrv: certificat

	hnote over chksrv : Generate the sha1 and sha256 of the certificate\nPut it with random data in AES 256 GCM message

	chksrv -> chkaddon: AES 256 GCM message
end

hnote over chkaddon :If all hashs are same : ok\nelse warning

chkaddon -> Firefox:Ok or warning
@enduml

PlantUML version 1.2020.01beta5(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.7.0_25-b15
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>